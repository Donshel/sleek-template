%%%%% Packages

\usepackage{amsthm}

%%%%% Settings

\renewcommand{\qedsymbol}{$\blacksquare$}

\begingroup
\makeatletter
\@for\theoremstyle:=plain,definition,remark\do{
	\expandafter\g@addto@macro\csname th@\theoremstyle\endcsname{
		\addtolength\thm@preskip\parskip
	}
}
\endgroup

\ifx\lgthm\undefined
	\def\lgthm{Theorem}
	\def\lgprf{Proof}
	\def\lglem{Lemma}
	\def\lgprop{Proposition}
	\def\lgdefn{Definition}
	\def\lghyp{Hypothesis}
	\def\lgquest{Question}
	\def\lgansw{Answer}
	\def\lgexpl{Example}
	\def\lgrmk{Remark}
	\def\lgnote{Note}
	\def\lgtip{Tip}
\fi

%%%%% Environments

\theoremstyle{plain}
\newtheorem{thm}{\lgthm}
\newtheorem{lem}[thm]{\lglem}
\newtheorem{prop}{\lgprop}

\theoremstyle{definition}
\newtheorem{defn}{\lgdefn}
\newtheorem{hyp}{\lghyp}
\newtheorem{quest}{\lgquest}

\theoremstyle{remark}
\newtheorem{answ}{\lgansw}[quest]
\newtheorem{expl}{\lgexpl}
\newtheorem*{rmk}{\lgrmk}
\newtheorem*{note}{\lgnote}
\newtheorem*{tip}{\lgtip}

% framed

\newenvironment{framedtext}[5]{
	\ifstrempty{#1}{}{\refstepcounter{#1}}
	\mdfsetup{
		frametitle={
			\tikz[baseline=(current bounding box.east), outer sep=0pt]
			\node[anchor=east, rectangle, fill=\ifstrempty{#3}{black!10}{#3}]
			{\strut \ifstrempty{#4}{}{#4~}\ifstrempty{#2}{}{\csname the#2\endcsname.~}\ifstrempty{#5}{}{#5~}};
		},
		innertopmargin=0.5em,
		linecolor=\ifstrempty{#3}{black!10}{#3},
		linewidth=2pt,
		topline=true,
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax
	}
	\begin{mdframed}[skipabove=1em, skipbelow=0.5em] \relax
}{\end{mdframed}}

\newenvironment{framedthm}[1][]{\begin{framedtext}{thm}{thm}{red!20}{\lgthm}{#1}}{\end{framedtext}}
\newenvironment{framedprf}[1][]{\begin{framedtext}{}{thm}{}{\lgprf}{#1}}{\qed\end{framedtext}}
\newenvironment{frameddefn}[1][]{\begin{framedtext}{defn}{defn}{black!20!green!20}{\lgdefn}{#1}}{\end{framedtext}}
\newenvironment{framedquest}[1][]{\begin{framedtext}{quest}{quest}{green!20!blue!20}{\lgquest}{#1}}{\end{framedtext}}
\newenvironment{framedansw}[1][]{\begin{framedtext}{answ}{answ}{}{\lgansw}{#1}}{\end{framedtext}}
